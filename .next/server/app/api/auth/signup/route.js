"use strict";(()=>{var e={};e.id=3654,e.ids=[3654],e.modules={53524:e=>{e.exports=require("@prisma/client")},72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},14300:e=>{e.exports=require("buffer")},6113:e=>{e.exports=require("crypto")},12781:e=>{e.exports=require("stream")},73837:e=>{e.exports=require("util")},53052:(e,r,t)=>{t.r(r),t.d(r,{headerHooks:()=>v,originalPathname:()=>w,patchFetch:()=>x,requestAsyncStorage:()=>m,routeModule:()=>f,serverHooks:()=>y,staticGenerationAsyncStorage:()=>h,staticGenerationBailout:()=>E});var o={};t.r(o),t.d(o,{POST:()=>g,dynamic:()=>d});var s=t(95419),n=t(69108),a=t(99678),i=t(78070),c=t(47033),l=t(6521),u=t(7439),p=t(3205);let d="force-dynamic";async function g(e){try{try{await c._B.$queryRaw`SELECT 1`,console.log("[Sign Up] Database connection confirmed")}catch(e){return console.error("[Sign Up] Database connection failed:",e),i.Z.json({error:"Database connection failed",details:e.message},{status:500})}let{email:r,password:t}=await e.json();if(console.log(`[Sign Up] Attempt for email: ${r}`),!r||!t)return console.log("[Sign Up] Missing email or password"),i.Z.json({error:"Email and password are required"},{status:400});if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(r))return console.log(`[Sign Up] Invalid email format: ${r}`),i.Z.json({error:"Invalid email format"},{status:400});if(t.length<6)return console.log(`[Sign Up] Password too short for: ${r}`),i.Z.json({error:"Password must be at least 6 characters"},{status:400});try{if(await c._B.user.findUnique({where:{email:r}}))return console.log(`[Sign Up] User already exists: ${r}`),i.Z.json({error:"User with this email already exists"},{status:409});console.log(`[Sign Up] Creating new user: ${r}`);let e=await l.hash(t,10),o=await c._B.user.create({data:{email:r,password:e}});console.log(`[Sign Up] User created: ${r}`);try{let e=(0,p.V3)({userId:o.id,email:o.email});console.log(`[Sign Up] Token created for: ${r}`),(0,u.cookies)().set({name:"__clerk_db_jwt",value:e,httpOnly:!0,path:"/",secure:!0,maxAge:604800,sameSite:"lax"});let{password:t,...s}=o;return console.log(`[Sign Up] Success for: ${r}`),i.Z.json({user:s,success:!0},{status:201})}catch(s){console.error(`[Sign Up] Token creation error for ${r}:`,s);let{password:e,...t}=o;return i.Z.json({user:t,success:!0,autoLogin:!1},{status:201})}}catch(e){throw console.error("[Sign Up] Database error:",e),Error(`Database operation failed: ${e.message}`)}}catch(e){return console.error("Error creating user:",e),i.Z.json({error:"Failed to create user",details:e.message},{status:500})}}let f=new s.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/auth/signup/route",pathname:"/api/auth/signup",filename:"route",bundlePath:"app/api/auth/signup/route"},resolvedPagePath:"C:\\Pliv\\app\\api\\auth\\signup\\route.ts",nextConfigOutput:"",userland:o}),{requestAsyncStorage:m,staticGenerationAsyncStorage:h,serverHooks:y,headerHooks:v,staticGenerationBailout:E}=f,w="/api/auth/signup/route";function x(){return(0,a.patchFetch)({serverHooks:y,staticGenerationAsyncStorage:h})}},3205:(e,r,t)=>{t.d(r,{V3:()=>n,WX:()=>a});var o=t(46082);function s(){let e=process.env.CLERK_SECRET_KEY||process.env.JWT_SECRET||"fallback-secret-key-change-me";return"fallback-secret-key-change-me"===e&&console.warn("WARNING: Using fallback secret key. Set CLERK_SECRET_KEY or JWT_SECRET environment variable."),e}function n(e){let r=s();try{console.log(`Creating token for user: ${e.userId}`);let t=(0,o.sign)(e,r,{expiresIn:"7d"});try{return(0,o.verify)(t,r),console.log(`Token created and verified successfully for user: ${e.userId}`),t}catch(e){throw console.error("Token verification after creation failed:",e),e}}catch(e){throw console.error("Token creation failed:",e),e}}function a(e){try{console.log("Verifying token...");let r=s(),t=(0,o.verify)(e,r);return console.log(`Token verified successfully for user: ${t.userId}`),t}catch(e){return console.error("Error verifying token:",e),null}}},47033:(e,r,t)=>{t.d(r,{_B:()=>a,wv:()=>i});var o=t(53524);let s=(()=>{try{if("undefined"!=typeof process&&"1"===process.env.VERCEL)return!0;return!1}catch(e){return!1}})(),n="phase-production-build"===process.env.NEXT_PHASE||process.env.VERCEL&&"production"===process.env.NEXT_PUBLIC_VERCEL_ENV||process.env.VERCEL_ENV||s,a=global.prisma||(n?(console.log("Static generation detected, using mock database client"),new Proxy({},{get:(e,r)=>"$connect"===r||"$disconnect"===r?async()=>{}:()=>new Proxy({},{get:()=>()=>Promise.resolve([]),apply:()=>Promise.resolve([])})})):new o.PrismaClient({log:["error"]}));async function i(e,r){try{if(n)return console.log("Static generation detected, returning fallback data"),r;return await e()}catch(e){return console.error("Database operation failed:",e),r}}}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),o=r.X(0,[1638,6206,7439,6082,6521],()=>t(53052));module.exports=o})();